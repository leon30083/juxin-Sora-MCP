# 角色视频功能说明

## 概述

聚鑫MCP服务器现已支持角色视频创建功能。您可以：

1. **从现有视频中创建角色** - 使用 `create_character` 工具
2. **使用角色创建视频** - 在 `create_video` 工具的提示词中使用 `@角色名`

## 角色创建

### 使用 MCP 工具

```javascript
// 创建角色
{
  "name": "create_character",
  "arguments": {
    "url": "https://example.com/video.mp4",
    "timestamps": "1,3"
  }
}
```

### 参数说明

- `url`: 包含要创建角色的视频URL
- `timestamps`: 角色出现的时间段，格式为 "开始秒,结束秒"
  - 注意：时间范围差值最大3秒，最小1秒

### 角色创建响应

```json
{
  "id": "ch_6918d62178e48191a0b1ae49be428a13",
  "username": "角色名",
  "permalink": "https://sora.chatgpt.com/profile/角色名",
  "profile_picture_url": "角色头像URL"
}
```

## 角色视频创建

### 使用角色

创建角色后，您可以在提示词中使用 `@角色名` 来创建包含该角色的视频。

### MCP 工具示例

```javascript
{
  "name": "create_video",
  "arguments": {
    "prompt": "@角色名 在樱花树下散步，花瓣飘落，电影大片感",
    "orientation": "landscape",
    "size": "small",
    "duration": 15,
    "watermark": false,
    "private": true
  }
}
```

## 提供的角色

以下是已经可用的角色：

| 角色 | 角色名 | 描述 |
|------|--------|------|
| 李元吉 | jasvwqpvt.hanblueher | 唐朝将领 |
| 李建成 | fpjhyfzxl.grandvizie | 唐朝太子 |
| 李世民 | rsgvoepwj.valor_knig | 唐太宗 |

您可以直接在提示词中使用这些角色，例如：
- `@jasvwqpvt.hanblueher 在战场上英勇作战`
- `@fpjhyfzxl.grandvizie 在宫殿中处理政务`
- `@rsgvoepwj.valor_knig 登基称帝`

## 测试脚本

### 1. 测试角色创建

```bash
node test-character.js
```

### 2. 测试提供的角色

```bash
node test-provided-characters.js
```

### 3. 查询任务状态

```bash
# 查询单个任务
node query-single-task.js <task-id>

# 查询所有角色任务
cat character-task-ids.txt | xargs -I {} node query-single-task.js {}
```

## 注意事项

1. **角色创建限制**：
   - 时间戳范围必须在1-3秒之间
   - 视频必须包含清晰的人物形象

2. **角色视频**：
   - 提示词中的 `@角色名` 必须是有效的角色用户名
   - 角色名区分大小写

3. **任务跟踪**：
   - 所有角色视频创建任务都会自动记录
   - 使用 `list_tasks` 工具可以查看所有任务状态

## 示例工作流

```javascript
// 1. 创建角色
const character = await create_character({
  url: "https://example.com/my-video.mp4",
  timestamps: "2,4"
});

// 2. 使用角色创建视频
const video = await create_video({
  prompt: `@${character.username} 在海边看日落，温馨浪漫`,
  orientation: "landscape"
});

// 3. 查询状态
const status = await query_video_status({
  task_id: video.id
});
```

## 常见问题

### Q: 角色创建失败怎么办？
A: 请检查：
- 视频URL是否有效
- 时间戳格式是否正确（例如 "1,2"）
- 时间范围是否在1-3秒之间

### Q: 角色视频生成失败？
A: 请确保：
- 使用正确的角色用户名
- 提示词中使用了 `@` 前缀
- 角色用户名拼写正确

### Q: 如何查看我创建的所有角色？
A: 角色创建后会返回角色主页链接，您可以在浏览器中打开查看详情。